(this["webpackJsonpchess-react"]=this["webpackJsonpchess-react"]||[]).push([[0],{12:function(e,t){var a=function(e,t,a){var r=a.width/8;t.lineWidth=.065*r,t.lineCap="round";for(var s=1;s<9;){for(var c=0;c<8;)s%2!==0?c%2===0?(t.fillStyle=e?o.dark.darkSquare:o.normal.darkSquare,t.fillRect(c*r,a.width-r*s,r,r)):(t.fillStyle=e?o.dark.lightSquare:o.normal.lightSquare,t.fillRect(c*r,a.width-r*s,r,r)):c%2!==0?(t.fillStyle=e?o.dark.darkSquare:o.normal.darkSquare,t.fillRect(c*r,a.width-r*s,r,r)):(t.fillStyle=e?o.dark.lightSquare:o.normal.lightSquare,t.fillRect(c*r,a.width-r*s,r,r)),c++;s++}},r=function(e,t,a,r,s,o){e.beginPath(),e.strokeStyle="w"===o?t:a,e.moveTo(r.x,r.y),e.lineTo(s.x,s.y),e.stroke()},s={a:0,b:1,c:2,d:3,e:4,f:5,g:6,h:7},o={normal:{darkSquare:"#e4e4e4",lightSquare:"#f5f5f5"},dark:{darkSquare:"#000",lightSquare:"#4a4a4a"}};e.exports.updateBoard=function(e,t,o,c,n,i,l){e.clearRect(0,0,o.width,o.height),a(i,e,o);var h=t.history({verbose:!0}),d=[];h.forEach((function(e){var t={from:e.from,to:e.to,color:e.color},a=[];a.push(t),d=d.concat(a)}));var p=o.width/8;d.forEach((function(t,a){var i=t.from,h=t.to,u=i[0],g=parseInt(i[1])-1,j=s[u],b={x:p/2+p*j,y:o.width-p/2-p*g},f=h[0],v=parseInt(h[1])-1,m=s[f],O={x:p/2+p*m,y:o.width-p/2-p*v};r(e,c,n,b,O,t.color),a===d.length-1&&l&&(e.beginPath(),e.arc(O.x,O.y,p/8,0,2*Math.PI),e.stroke())}))},e.exports.fillBoard=a},21:function(e,t,a){},40:function(e,t,a){"use strict";a.r(t);var r=a(0),s=a.n(r),o=a(14),c=a.n(o),n=a(23),i=a(7),l=a(8),h=a(10),d=a(9),p=(a(21),a(15)),u=a.n(p),g=a(1),j=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={},e.saveToServer=function(){if(e.props.badInput||void 0===e.props.pgn)return e.props.error("There was a problem with your PGN. Please try again.");document.querySelector(".saveButton").disabled=!0;var t={pgn:e.props.chess.pgn(),whiteColor:e.props.whiteColor,blackColor:e.props.blackColor,darkMode:e.props.darkMode?1:0,highlightLastMove:e.props.highlightLastMove?1:0},a=new XMLHttpRequest;a.open("POST","https://nf6.io/add",!0),a.setRequestHeader("Content-Type","application/json"),a.onload=function(){if(4===a.readyState)if(200===a.status){var t=JSON.parse(a.response);console.log(t),e.props.handleOtherChange(t.id,"fetchedID"),e.props.localSetter(t,"created")}else console.warn("There be errors about here")},a.send(JSON.stringify(t))},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(g.jsxs)("div",{className:"controls",children:[Object(g.jsx)("textarea",{id:"importGame",cols:"30",rows:"10",placeholder:"Input PGN",onChange:function(t){e.props.handlePGN(t.target.value)}}),Object(g.jsxs)("div",{className:"row",children:[Object(g.jsxs)("label",{htmlFor:"whiteColor",children:["White Color",Object(g.jsx)("input",{value:this.props.whiteColor,type:"color",onChange:function(t){e.props.handleOtherChange(t.target.value,"whiteColor")}})]}),Object(g.jsxs)("label",{htmlFor:"blackColor",children:["Black color",Object(g.jsx)("input",{value:this.props.blackColor,type:"color",onChange:function(t){e.props.handleOtherChange(t.target.value,"blackColor")}})]}),Object(g.jsxs)("label",{className:"full",children:["Dark mode?",Object(g.jsxs)("label",{className:"switch",children:[Object(g.jsx)("input",{type:"checkbox",defaultChecked:this.props.darkMode,onChange:function(t){e.props.handleOtherChange(t.target.checked,"darkMode")}}),Object(g.jsx)("span",{className:"slider round"})]})]}),Object(g.jsxs)("label",{className:"full",children:["Highlight Last move?",Object(g.jsxs)("label",{className:"switch",children:[Object(g.jsx)("input",{type:"checkbox",defaultChecked:this.props.highlightLastMove,onChange:function(t){e.props.handleOtherChange(t.target.checked,"highlightLastMove")}}),Object(g.jsx)("span",{className:"slider round"})]})]})]}),Object(g.jsx)("div",{children:Object(g.jsx)("button",{className:"saveButton",onClick:this.saveToServer,children:"Save design!"})})]})}}]),a}(r.Component),b=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={},e.copyToClipboard=function(){if(window.navigator.clipboard){var t="https://nf6.io/"+e.props.fetchedID;window.navigator.clipboard.writeText(t).then((function(){console.log("Wrote to clipboard: ".concat(t)),e.props.success("Copied URL to clipboard!")}),(function(){e.props.error("Failed to copy to clipboard. Please try manually copying the URL!")}))}},e}return Object(l.a)(a,[{key:"render",value:function(){return Object(g.jsxs)("div",{className:"messageContainer",children:[!this.props.fetchedID&&Object(g.jsxs)("div",{className:"message warn",children:[Object(g.jsx)("span",{className:"material-icons",children:"warning"}),Object(g.jsxs)("p",{children:["Once you press save, you'll be given a unique URL and won't be able to change your design. ",Object(g.jsx)("strong",{children:"Copy your URL before closing the page! "}),"Go to ",Object(g.jsx)("a",{href:"https://nf6.io/recents",children:"https://nf6.io/recents"})," to see your recently viewed and created games."]})]}),this.props.fetchedID&&Object(g.jsx)("div",{className:"message success",children:Object(g.jsxs)("p",{children:["https://nf6.io/",this.props.fetchedID,Object(g.jsx)("button",{onClick:this.copyToClipboard,children:Object(g.jsx)("span",{className:"material-icons",children:"content_copy"})})]})})]})}}]),a}(r.Component),f=a(16),v=(a(34),a(12)),m=a.n(v),O=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={darkMode:!1,whiteColor:"#81ebfd",blackColor:"#d24b4b",highlightLastMove:!0},e.chess=new u.a,e.files={a:0,b:1,c:2,d:3,e:4,f:5,g:6,h:7},e.squareColors={normal:{darkSquare:"#888",lightSquare:"#eee"},dark:{darkSquare:"#000",lightSquare:"#4a4a4a"}},e.componentDidMount=function(){e.canvas=document.querySelector("canvas"),e.ctx=e.canvas.getContext("2d"),e.square=e.canvas.width/8,e.ctx.lineWidth=.065*e.square,e.ctx.lineCap="round",m.a.fillBoard(e.state.darkMode,e.ctx,e.canvas),document.chess=e.chess;var t=window.location.pathname.slice(1);if(t){var a=e.localGetter(t,"viewed")[0],r=e.localGetter(t,"created")[0];if(a||r)return console.log("Found local game!"),e.loadGame(a||r),a||r;console.log("fetching"),e.setState({fetchingGame:!0},(function(){e.fetchFromServer(t)}))}},e.loadGame=function(t){if(t.err)return e.error("Couldn't find a game with that ID!");console.log(t),e.chess.load_pgn(t.pgn,{sloppy:!0});var a=e.chess.header();e.setState({fetchedGame:t,blackColor:t.blackColor,whiteColor:t.whiteColor,pgn:t.pgn,white:a.White,black:a.Black,result:a.Result,darkMode:t.darkMode,highlightLastMove:t.highlightLastMove,fetchingGame:!1},(function(){m.a.updateBoard(e.ctx,e.chess,e.canvas,e.state.whiteColor,e.state.blackColor,e.state.darkMode,e.state.highlightLastMove),console.log("test"),e.localGetter(t.id,"viewed")[0]||(console.log("test"),e.localSetter(t,"viewed"))}))},e.fetchFromServer=function(t){fetch("https://nf6.io/game/"+t).then((function(e){return e.json()})).then((function(t){return e.loadGame(t)})).catch((function(t){e.error("Couldn't find a game with that ID!")}))},e.handlePGN=function(t){e.chess.load_pgn(t,{sloppy:!0})?e.setState({pgn:t,badInput:!1},(function(){m.a.updateBoard(e.ctx,e.chess,e.canvas,e.state.whiteColor,e.state.blackColor,e.state.darkMode,e.state.highlightLastMove)})):e.setState({badInput:!0})},e.handleOtherChange=function(t,a){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.setState(Object(n.a)({},a,t),(function(){r&&r(),m.a.updateBoard(e.ctx,e.chess,e.canvas,e.state.whiteColor,e.state.blackColor,e.state.darkMode,e.state.highlightLastMove)}))},e.error=function(e){f.b.error(e,{position:"bottom-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})},e.success=function(e){f.b.success(e,{position:"bottom-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})},e.localGetter=function(e,t){var a=JSON.parse(window.localStorage.getItem(t));return!!a&&a.filter((function(t){return t.id===e}))},e.localSetter=function(e,t){null===window.localStorage.getItem(t)&&window.localStorage.setItem(t,"[]");var a=JSON.parse(window.localStorage.getItem(t));a.push(e),window.localStorage.setItem(t,JSON.stringify(a)),console.log("Added ".concat(e.id," to local storage: ").concat(t))},e}return Object(l.a)(a,[{key:"render",value:function(){return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("header",{children:Object(g.jsx)("a",{href:"/",children:Object(g.jsx)("img",{className:"logo",src:"./images/Nf6io-logo-final.png",alt:"Nf6.io Logo"})})}),Object(g.jsx)("div",{className:"container",children:Object(g.jsxs)("div",{className:"wrapper",children:[this.state.fetchedGame&&this.state.white&&this.state.black&&Object(g.jsxs)("h1",{children:[this.state.white," vs ",this.state.black,this.state.result&&Object(g.jsx)("span",{className:"score",children:" "+this.state.result})]}),Object(g.jsx)("p",{id:"date"}),Object(g.jsx)("canvas",{width:"560",height:"560",style:{transform:this.state.flipped?"rotate(180deg)":""}}),this.state.fetchedGame&&Object(g.jsx)("p",{id:"pgn",children:this.chess.history().map((function(e,t){return t%2===0?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("b",{children:Math.ceil(t/2)+1+". "}),Object(g.jsx)(g.Fragment,{children:e+" "})]}):Object(g.jsx)(g.Fragment,{children:e+" "})}))}),!this.state.fetchedGame&&!this.state.fetchingGame&&Object(g.jsx)(j,{chess:this.chess,handlePGN:this.handlePGN,handleOtherChange:this.handleOtherChange,fetchedID:this.state.fetchedID,pgn:this.state.pgn,whiteColor:this.state.whiteColor,blackColor:this.state.blackColor,darkMode:this.state.darkMode,highlightLastMove:this.state.highlightLastMove,localSetter:this.localSetter,success:this.success,error:this.error,badInput:this.state.badInput}),!this.state.fetchedGame&&!this.state.fetchingGame&&Object(g.jsx)(b,{fetchedID:this.state.fetchedID,success:this.success,error:this.error}),Object(g.jsx)(f.a,{})]})})]})}}]),a}(r.Component),x=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={},e.cardTemplate=function(e){var t=new u.a;t.load_pgn(e.pgn);var a=t.header(),r="An artsy diagram based on a game of chess!";return a.White&&a.Black&&(r="An artsy chess diagram based on a game between ".concat(a.White," and ").concat(a.Black)),Object(g.jsx)("div",{className:"card",children:Object(g.jsxs)("a",{href:"https://nf6.io/"+e.id,children:[Object(g.jsx)("h3",{children:"".concat(a.White&&a.Black?"".concat(a.White," vs ").concat(a.Black):"No title")}),Object(g.jsx)("img",{src:"https://nf6.io/image/"+e.id+"/300",alt:r})]})},e.id)},e.componentDidMount=function(){var t=window.localStorage.getItem("viewed"),a=window.localStorage.getItem("created");e.setState({viewed:t,created:a})},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("header",{children:Object(g.jsx)("a",{href:"/",children:Object(g.jsx)("img",{className:"logo",src:"./images/Nf6io-logo-final.png",alt:"Nf6.io Logo"})})}),Object(g.jsxs)("div",{className:"recents",children:[Object(g.jsx)("h1",{children:"Recent Games"}),Object(g.jsx)("h2",{children:"Recently viewed"}),Object(g.jsx)("div",{className:"cardContainer",children:this.state.viewed&&JSON.parse(this.state.viewed).map((function(t){return e.cardTemplate(t)}))}),Object(g.jsx)("h2",{children:"Recently created"}),Object(g.jsx)("div",{className:"cardContainer",children:this.state.created&&JSON.parse(this.state.created).map((function(t){return e.cardTemplate(t)}))})]})]})}}]),a}(r.Component),w=a(24),k=a(2),C=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={},e}return Object(l.a)(a,[{key:"render",value:function(){return Object(g.jsx)(w.a,{children:Object(g.jsxs)(k.c,{children:[Object(g.jsx)(k.a,{exact:!0,path:"/recents",children:Object(g.jsx)(x,{},"recents")}),Object(g.jsx)(k.a,{path:"/",children:Object(g.jsx)(O,{},"app")})]})})}}]),a}(r.Component);c.a.render(Object(g.jsx)(s.a.StrictMode,{children:Object(g.jsx)(C,{})}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.1333f486.chunk.js.map